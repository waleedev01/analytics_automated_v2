
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configuring A Basic Job &#8212; analytics_automated 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using A Basic Job" href="using_a_basic_job.html" />
    <link rel="prev" title="Building Jobs Overview" href="the_Job_UI.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="configuring-a-basic-job">
<span id="id1"></span><h1>Configuring A Basic Job<a class="headerlink" href="#configuring-a-basic-job" title="Permalink to this headline">¶</a></h1>
<p>Here we run through configuring a simple job assuming default queue and
validator types. See the admin documentation to configure these.</p>
<div class="section" id="backend">
<h2>Backend<a class="headerlink" href="#backend" title="Permalink to this headline">¶</a></h2>
<p>First we use the Django Admin to navigate to the Backend admin page,
<a class="reference external" href="http://127.0.0.1:8000/admin/analytics_automated/backend/">http://127.0.0.1:8000/admin/analytics_automated/backend/</a>.
Then selecting the ‘+ Add Backend’ option we can configure a newtype of backend
We’ll configure a new backend called ‘local1’, with a Queue Type
of ‘localhost’ and we leave the root path with the default called ‘/tmp/’.</p>
<p>Hitting save makes this backend configuration available to tasks</p>
<img alt="_images/backend_example.png" src="_images/backend_example.png" />
<p>There are 4 queue types for different types of execution behaviour. Localhost
will run a command as though you are running a binary from a <a href="#id2"><span class="problematic" id="id3">*</span></a>nix commandline.
GridEngine will submit a command to a DRMAA compliant grid engine queue if
you have installed and configured this on the machine the workers are running
on. R and Python will run chunks of code in those languages directly.</p>
<p>You can define new queue types and set their execution behaviour. If you
do this you must restart the Celery workers with that queue type. You may also
need to set the LOW and HIGH version of these queue types if you’re managing
user load.</p>
</div>
<div class="section" id="task">
<h2>Task<a class="headerlink" href="#task" title="Permalink to this headline">¶</a></h2>
<p>With a backend configured we can configure some tasks. Navigate to the Task menu,
<a class="reference external" href="http://127.0.0.1:8000/admin/analytics_automated/task/">http://127.0.0.1:8000/admin/analytics_automated/task/</a>, and select the ‘+ Add Task’ option.</p>
<img alt="_images/task1_example.png" src="_images/task1_example.png" />
<p>Our first task will run the unix command ls on the /tmp directory. We give it
a name and a useful human readable description. With ‘In Glob’
set to .input the data the user provided to the system will be available in a file
ending with the suffix .input. ‘Out Glob’ specifies the files of data that should
be gathered up after the command runs and made available to the user. In this case
the system will look for a file ending with .contents after the process runs.</p>
<p>Setting the ‘Stdout glob’ tells the system to redirect the command’s std out
stream into a file ending with .contents. In this way the output of the command
is sent to a file ending in .contents and we’ve told the task to gatther up
such files to make them available to the user.</p>
<p>If the backend is a GridEngine or localhost queue types then the executable
string is the commandline process that will be executed by the
task and sent to stdout. In this case a simple <cite>/bin/ls /tmp</cite> unix command.
Stdout and the captured file will contain the contents of the /tmp directory</p>
<p>If your backend is a Python or R type you can expand the text area and write
or paste R or Python code.</p>
<p>We are leaving the Job Termination, parameter and environment options blank
in this simple example.</p>
<p>Click save to make this task available</p>
<img alt="_images/task2_example.png" src="_images/task2_example.png" />
<p>The second task is a task that can consume the data generated by a previous task
As before we give the task a simple name and a human readable descriptions.
It defines it’s ‘In Glob’ as a file ending with <cite>.contents</cite>. When this task
runs it will search all previous tasks for output files which match this
criteria and use those files as input. Once again ‘Out glob’ defines the names
of files to be captured so the user can access them and ‘Stdout glob’ is the
suffix to use to capture the stdout of our executable string.</p>
<p>The executable string tells the task to run the unix wc command with the -l
switch to count the lines in the files. The $I1 control sequence names a file,
this refers to the 1st file in the ‘In glob’ field. So in this instance
we are asking the task to run wc -l on a file ending with .contents and then
capture the output in a file ending .count. We would expect the .count file
to now contain the number of lines in the .contents file.</p>
<p>As before we are leaving the Job Termination, parameter and environment options blank
in this simple example.</p>
<p>If you return to the <a class="reference external" href="http://127.0.0.1:8000/admin/analytics_automated/task/">http://127.0.0.1:8000/admin/analytics_automated/task/</a> you
can now see a summary of the two tasks available in the system.</p>
<img alt="_images/task_admin_example.png" src="_images/task_admin_example.png" />
<p>One thing to note is that the ‘In Glob’ setting will look for output files in
all prior completed tasks, not just the immediate task</p>
</div>
<div class="section" id="job">
<h2>Job<a class="headerlink" href="#job" title="Permalink to this headline">¶</a></h2>
<p>Now navigate to the Job Admin page, <a class="reference external" href="http://127.0.0.1:8000/admin/analytics_automated/job/">http://127.0.0.1:8000/admin/analytics_automated/job/</a>,
and select the ‘+ Add Job’. From here we can configure a job using the tasks that
are available in the system.</p>
<img alt="_images/job1_example.png" src="_images/job1_example.png" />
<p>Here we’ve given the job the name tmp_count as we’re going to use the previous
tasks to count the number of files present in the /tmp directory. We’ve selected
the ‘Runnable’ option. Jobs which are not Runnable will reject user submissions</p>
<p>This job does not rely on user input data so the validator option is left blank.</p>
<p>Under tasks we select the tasks we wish the job to run and use the ordering
to give sequential integer values which define the ordering of the tasks.
0 for our ‘ls /tmp &gt; .contents’ task and 1 for the ‘wc -l .contents’ task.</p>
<p>Now you have configured you’re first simple job in the system. Clicking save
will make this job live for users</p>
</div>
<div class="section" id="endpoints">
<h2>Endpoints<a class="headerlink" href="#endpoints" title="Permalink to this headline">¶</a></h2>
<p>You can now check <a class="reference external" href="http://127.0.0.1:8000/analytics_automated/endpoints/">http://127.0.0.1:8000/analytics_automated/endpoints/</a> to
see what jobs and URLS and parameters are avaialble to users.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">analytics_automated</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Basic Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_it_works.html">How The System Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="the_Job_UI.html">Building Jobs Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuring A Basic Job</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#backend">Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task">Task</a></li>
<li class="toctree-l2"><a class="reference internal" href="#job">Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="#endpoints">Endpoints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="using_a_basic_job.html">Using A Basic Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="job_admin.html">Administration Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Recipes for more advanced use-cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Uses</a></li>
<li class="toctree-l1"><a class="reference internal" href="periodic_tasks.html">Periodic Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration_settings.html">Configurations Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_installation.html">Development Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_cwl_feature.html">CWL File Requirements and Specifications</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="the_Job_UI.html" title="previous chapter">Building Jobs Overview</a></li>
      <li>Next: <a href="using_a_basic_job.html" title="next chapter">Using A Basic Job</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Daniel Buchan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/configuring_a_basic_job.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
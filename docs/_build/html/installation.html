
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Basic Installation &#8212; analytics_automated 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How The System Works" href="how_it_works.html" />
    <link rel="prev" title="Analytics Automated" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="basic-installation">
<span id="installation"></span><h1>Basic Installation<a class="headerlink" href="#basic-installation" title="Permalink to this headline">¶</a></h1>
<p>This guide will take you through setting up A_A in development mode. Analytics
automated is a Django application and has a couple of required dependencies</p>
<ul class="simple">
<li><p>Python3</p></li>
<li><p>postgreSQL</p></li>
<li><p>Redis</p></li>
<li><p>Celery 4.x</p></li>
<li><p>Django &gt;1.10</p></li>
</ul>
<div class="section" id="code-dependancies">
<h2>Code Dependancies<a class="headerlink" href="#code-dependancies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-python-3">
<h3>1. Get Python 3<a class="headerlink" href="#get-python-3" title="Permalink to this headline">¶</a></h3>
<p>You may also wish to sort out virtualenv and run the application within that, however that is beyond the scope of this installation guide</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">downloads</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="install-postgresql">
<h3>2. Install postgreSQL<a class="headerlink" href="#install-postgresql" title="Permalink to this headline">¶</a></h3>
<p>If you’re on a mac we advise using brew</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">postgres</span>
</pre></div>
</div>
<p>If you’re in a linux env some manner of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="n">postgres</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">postgres</span>
</pre></div>
</div>
</div>
<div class="section" id="install-redis">
<h3>3. Install Redis<a class="headerlink" href="#install-redis" title="Permalink to this headline">¶</a></h3>
<p>One of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">redis</span>

<span class="n">yum</span> <span class="n">install</span> <span class="n">redis</span>

<span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">redis</span>
</pre></div>
</div>
</div>
<div class="section" id="get-the-analytics-automated">
<h3>4. Get the Analytics Automated<a class="headerlink" href="#get-the-analytics-automated" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">AnalyticsAutomated</span><span class="o">/</span><span class="n">analytics_automated</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>This will place the code in a dir called <cite>analytics_automated/</cite></p>
</div>
<div class="section" id="install-the-python-packages-needed">
<h3>5. Install the python packages needed<a class="headerlink" href="#install-the-python-packages-needed" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">analytics_automated</span><span class="o">/</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">/</span><span class="n">dev</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pre-launch-configuration">
<h2>Pre-launch configuration<a class="headerlink" href="#pre-launch-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="set-up-postgres">
<h3>1. Set Up Postgres<a class="headerlink" href="#set-up-postgres" title="Permalink to this headline">¶</a></h3>
<p>You need to setup some bits and pieces in postgres before we start</p>
<ul>
<li><p>You may need to initialise postgres:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initdb</span> <span class="o">-</span><span class="n">D</span> <span class="p">[</span><span class="n">SOME_PATH</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Start the postgres daemon:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pg_ctl</span> <span class="n">start</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">scratch0</span><span class="o">/</span><span class="n">NOT_BACKED_UP</span><span class="o">/</span><span class="n">dbuchan</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">logfile</span> <span class="o">-</span><span class="n">D</span> <span class="n">scratch0</span><span class="o">/</span><span class="n">NOT_BACKED_UP</span><span class="o">/</span><span class="n">dbuchan</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p>Then login:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">h</span> <span class="n">localhost</span> <span class="o">-</span><span class="n">d</span> <span class="n">postgres</span>
</pre></div>
</div>
</li>
<li><p>Now create the django db user for A_A</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">a_a_user</span> <span class="k">WITH</span> <span class="n">LOGIN</span> <span class="n">PASSWORD</span> <span class="s1">&#39;thisisthedevelopmentpasswordguys&#39;</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">analytics_automated_db</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">analytics_automated_db</span> <span class="k">TO</span> <span class="n">a_a_user</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">USER</span> <span class="n">a_a_user</span> <span class="k">CREATEDB</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="now-configure-django">
<h3>2. Now configure Django<a class="headerlink" href="#now-configure-django" title="Permalink to this headline">¶</a></h3>
<p>We maintain the idea of separate secrets files which only you have control of. You need to create these and populate them.
base_secrets.json are site wide settings which dev and production will use.
dev_secrets.json are settings which only the dev installation will will access.
A production system will need a production_secrets.json</p>
<ul>
<li><p>Create the files we need:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd analytics_automated_project/settings
touch base_secrets.json`
touch dev_secrets.json`
</pre></div>
</div>
</li>
<li><p>If you’re using bugsnag add your bugsnag key to base_secrets.json:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;BUGSNAG&quot;</span><span class="p">:</span> <span class="s2">&quot;YOUR KEY HERE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Add the dev_secrets.json settings needed to start in developments mode. The postgres login credentials and the secret key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;USER&quot;</span><span class="p">:</span> <span class="s2">&quot;a_a_user&quot;</span><span class="p">,</span>
  <span class="s2">&quot;PASSWORD&quot;</span><span class="p">:</span> <span class="s2">&quot;thisisthedevelopmentpasswordguys&quot;</span><span class="p">,</span>
  <span class="s2">&quot;SECRET_KEY&quot;</span><span class="p">:</span> <span class="s2">&quot;VERY LONG KEY HERE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Next open the base settings files in <cite>analytics_automated_project/settings/base.py</cite>
In here you’ll find a section at the top labelled “Required A_A user settings”.
These are all the things you need set for the app to run. We prefer to keep
theses settings in dev.py and production.py files. Then we can start the server
in different configs for different purposes.
Either uncomment all these in base.py or move them to dev.py or production.py and
set them there. You can leave the smtp settings commented if you do not wish to
send alerts via email to your users.</p></li>
</ul>
</div>
<div class="section" id="starting-a-a-in-development-localhost-mode">
<h3>3. Starting A_A in development localhost mode<a class="headerlink" href="#starting-a-a-in-development-localhost-mode" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Start Redis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redis</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
</li>
<li><p>Start the celery workers, from the root dir of A_A. Note that we have to specify
the queues the workers read from (-Q), for the basic settings we’ll have
these workers just watch all the default queues, note that the
workers are watching the low priority, normal priority and high priority.
In a more complex set up you can have different worker pools on different
machines watch specific queues.
localhost queues:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">analytics_automated</span><span class="o">/</span>
<span class="n">celery</span> <span class="o">--</span><span class="n">app</span><span class="o">=</span><span class="n">analytics_automated_project</span><span class="o">.</span><span class="n">celery</span><span class="p">:</span><span class="n">app</span> <span class="n">worker</span> <span class="o">--</span><span class="n">loglevel</span><span class="o">=</span><span class="n">INFO</span> <span class="o">-</span><span class="n">Q</span> <span class="n">low_localhost</span><span class="p">,</span><span class="n">localhost</span><span class="p">,</span><span class="n">high_localhost</span><span class="p">,</span><span class="n">low_GridEngine</span><span class="p">,</span><span class="n">GridEngine</span><span class="p">,</span><span class="n">high_GridEngine</span><span class="p">,</span><span class="n">low_R</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">high_R</span><span class="p">,</span><span class="n">low_Python</span><span class="p">,</span><span class="n">Python</span><span class="p">,</span><span class="n">high_Python</span>
</pre></div>
</div>
</li>
<li><p>Run the Django migrations to configure the database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">analytics_automated</span><span class="o">/</span>
<span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span> <span class="o">--</span><span class="n">settings</span><span class="o">=</span><span class="n">analytics_automated_project</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">dev</span>
</pre></div>
</div>
</li>
<li><p>Add an admin user to the Django application:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">analytics_automated</span><span class="o">/</span>
<span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">createsuperuser</span>
</pre></div>
</div>
</li>
<li><p>Now start A_A, again from the root dir of the app. Note we’ll start it assuming
you put the users settings in settings/dev.py:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">analytics_automated</span><span class="o">/</span>
<span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runserver</span> <span class="o">--</span><span class="n">settings</span><span class="o">=</span><span class="n">analytics_automated_project</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">dev</span>
</pre></div>
</div>
</li>
<li><p>ALTERNATIVELY
We also provide some scripts for bash and OSX in the utilities/ directory
which will start all the components on one machine.</p></li>
<li><p>Scheduled tasks. If you are going to user celery-beat then you may want to add a
queue name for scheduled tasks to the workers and starting the beat service.</p></li>
</ul>
</div>
<div class="section" id="config-complete">
<h3>4. Config complete<a class="headerlink" href="#config-complete" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>You should now be running all the components of A_A on a single machine with
a set of workers watching the localhost queue. This means we can now configure
data analysis pipelines which run code on the machine which the workers are running on.
This is the most basic setup we can run Redis, the web app, the database and the workers
on completely separate machines and even run multiple instances of the workers watching
the same queue. We’ll deal with this set in the <a class="reference internal" href="advanced.html#advanced-uses"><span class="std std-ref">Advanced Uses</span></a> tutorial.</p>
</div></blockquote>
</div>
<div class="section" id="now-move-on-to-how-it-works">
<h3>5. Now move on to <a class="reference internal" href="how_it_works.html#how-it-works"><span class="std std-ref">How The System Works</span></a><a class="headerlink" href="#now-move-on-to-how-it-works" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">analytics_automated</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#code-dependancies">Code Dependancies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-launch-configuration">Pre-launch configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="how_it_works.html">How The System Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="the_Job_UI.html">Building Jobs Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring_a_basic_job.html">Configuring A Basic Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_a_basic_job.html">Using A Basic Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="job_admin.html">Administration Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Recipes for more advanced use-cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Uses</a></li>
<li class="toctree-l1"><a class="reference internal" href="periodic_tasks.html">Periodic Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration_settings.html">Configurations Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_installation.html">Development Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_cwl_file.html">CWL File Requirements and Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_cwl_file.html#simple-cwl-guidance">Simple CWL Guidance</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Analytics Automated</a></li>
      <li>Next: <a href="how_it_works.html" title="next chapter">How The System Works</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Daniel Buchan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/installation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>